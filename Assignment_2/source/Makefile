# Write The Main Code Name Here Without Any Extensions

# Compiler 
CC = gcc

# Compiler flags
CFLAGS= -Wall -pg

# Linking flags
LDFLAGS= -lm -I../include/  

# Executable name
EXECNAME= main

# The output path of the binary file generated
OUTPUT_PATH = ../bin/

# The Input Path for Header Files and Objects
INPUT_PATH = ./

# Specify Headers : The ".h" Files for your Library 
HEADERS = $(INPUT_PATH)../include/structures.h \
		 
# Specify Objects : The ".o" Files Generated by Compiling the ".c" Files
OBJECTS = $(INPUT_PATH)tcb_functions.o \
	$(INPUT_PATH)rm_analysis.o \
	$(INPUT_PATH)edf_analysis.o \
	$(INPUT_PATH)dm_analysis.o   \
	$(INPUT_PATH)fp_analysis.o \
	$(INPUT_PATH)schedulability_analysis.o \
		  
		  
# Compilation of the Main Code
ifneq ($(MAKECMDGOALS), clean)
$(MAKECMDGOALS) : $(MAKECMDGOALS).o $(OBJECTS)
	$(CC) -o $(OUTPUT_PATH)$(EXECNAME) $(CFLAGS) $(MAKECMDGOALS).o $(OBJECTS) $(LDFLAGS) 

# Main Code Object File
$(MAKECMDGOALS).o : $(MAKECMDGOALS).c $(HEADERS) $(OPENCV_HEADERS)
	$(CC) -c $(MAKECMDGOALS).c $(LDFLAGS) $(CFLAGS)
endif

# Object File for tcb function file
$(INPUT_PATH) tcb_functions.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@) -o $@ $(CFLAGS) $(LDFLAGS)

# Object File for Rate Monotonic function file
$(INPUT_PATH)rm_analysis.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@)  -o $@ $(CFLAGS) $(LDFLAGS)


# Object File for EDF function file
$(INPUT_PATH)edf_analysis.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@)  -o $@ $(CFLAGS) $(LDFLAGS)

# Object File for Deadline Monotonic function file
$(INPUT_PATH)dm_analysis.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@)  -o $@ $(CFLAGS) $(LDFLAGS)


# Object File for fixed priority function file
$(INPUT_PATH)fp_analysis.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@) -o $@ $(CFLAGS) $(LDFLAGS)	

# Object File for schedulability analysis function file
$(INPUT_PATH)schedulability_analysis.o : $(patsubst %.o, %.c, $@) $(INPUT_PATH)../include/structures.h
	$(CC) -c $(patsubst %.o, %.c, $@) -o $@ $(CFLAGS) $(LDFLAGS)	


.PHONY : clean
clean :
	rm -f $(OBJECTS) *.o
	rm -f $(OUTPUT_PATH)$(EXECNAME)
